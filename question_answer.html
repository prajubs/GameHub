<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BrainDuel Pro - The Ultimate Q&A Challenge</title>
    <style>
        :root {
            --primary: #6c5ce7;
            --primary-dark: #5649c0;
            --secondary: #a29bfe;
            --success: #00b894;
            --success-dark: #00997d;
            --danger: #d63031;
            --danger-dark: #b52a2a;
            --warning: #fdcb6e;
            --dark: #2d3436;
            --light: #f5f6fa;
            --gray: #dfe6e9;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--light);
            color: var(--dark);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid var(--gray);
            margin-bottom: 30px;
        }
        
        .logo {
            font-size: 28px;
            font-weight: bold;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo img {
            height: 36px;
        }
        
        .auth-buttons {
            display: flex;
            gap: 10px;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .profile-pic {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
        }
        
        .user-wallet {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .wallet-balance {
            background-color: var(--primary);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-sm {
            padding: 6px 12px;
            font-size: 14px;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background-color: var(--success-dark);
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: white;
        }
        
        .btn-danger:hover {
            background-color: var(--danger-dark);
        }
        
        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--gray);
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            position: relative;
        }
        
        .tab.active {
            border-bottom: 3px solid var(--primary);
            font-weight: bold;
        }
        
        .tab-badge {
            position: absolute;
            top: -5px;
            right: 5px;
            background-color: var(--danger);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .game-area {
            display: flex;
            gap: 20px;
        }
        
        .main-content {
            flex: 2;
        }
        
        .sidebar {
            flex: 1;
        }
        
        .card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            align-items: center;
        }
        
        .card-title {
            font-size: 18px;
            font-weight: bold;
            color: var(--primary);
        }
        
        .badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .badge-primary {
            background-color: var(--secondary);
            color: white;
        }
        
        .badge-success {
            background-color: var(--success);
            color: white;
        }
        
        .badge-warning {
            background-color: var(--warning);
            color: var(--dark);
        }
        
        .badge-danger {
            background-color: var(--danger);
            color: white;
        }
        
        .question-text {
            margin-bottom: 15px;
            font-size: 16px;
            line-height: 1.5;
        }
        
        .question-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
            font-size: 14px;
            color: #666;
        }
        
        .question-author {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .author-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: var(--secondary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        .question-timer {
            color: var(--danger);
            font-weight: bold;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--gray);
            border-radius: 5px;
            transition: border 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .difficulty-tag {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 5px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .difficulty-easy {
            background-color: #a8e6cf;
            color: #1a6b4e;
        }
        
        .difficulty-medium {
            background-color: #ffd3b6;
            color: #b35900;
        }
        
        .difficulty-hard {
            background-color: #ffaaa5;
            color: #8b0000;
        }
        
        .hidden {
            display: none;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        
        .modal.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(-20px);
            transition: transform 0.3s;
        }
        
        .modal.active .modal-content {
            transform: translateY(0);
        }
        
        .modal-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 20px;
            font-weight: bold;
        }
        
        .modal-body {
            padding: 20px;
        }
        
        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid var(--gray);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px;
            border-radius: 5px;
            color: white;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            animation: slideIn 0.5s, fadeOut 0.5s 2.5s forwards;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .notification-icon {
            font-size: 20px;
        }
        
        .notification.success {
            background-color: var(--success);
        }
        
        .notification.error {
            background-color: var(--danger);
        }
        
        .notification.warning {
            background-color: var(--warning);
            color: var(--dark);
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
            margin: 5px 0;
        }
        
        .stat-label {
            font-size: 14px;
            color: #666;
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        .table th, .table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--gray);
        }
        
        .table th {
            background-color: var(--light);
            font-weight: bold;
            color: var(--dark);
        }
        
        .table tr:hover {
            background-color: rgba(0, 0, 0, 0.02);
        }
        
        .status-pending {
            color: var(--warning);
        }
        
        .status-resolved {
            color: var(--success);
        }
        
        .status-expired {
            color: #666;
        }
        
        .admin-actions {
            display: flex;
            gap: 5px;
        }
        
        @media (max-width: 768px) {
            .game-area {
                flex-direction: column;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .user-profile {
                width: 100%;
                justify-content: space-between;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-brain"></i>
                <span>BrainDuel Pro</span>
            </div>
            
            <div id="authButtons" class="auth-buttons">
                <button class="btn btn-outline" id="loginBtn">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
                <button class="btn btn-primary" id="registerBtn">
                    <i class="fas fa-user-plus"></i> Register
                </button>
            </div>
            
            <div id="userProfile" class="user-profile hidden">
                <div class="user-wallet">
                    <div class="wallet-balance">
                        <i class="fas fa-wallet"></i>
                        ₹<span id="balance">0</span>
                    </div>
                    <button class="btn btn-primary btn-sm" id="addFundsBtn">
                        <i class="fas fa-plus"></i> Add
                    </button>
                </div>
                <div class="profile-pic" id="profileInitial">U</div>
            </div>
        </header>
        
        <div class="tabs">
            <div class="tab active" data-tab="play">
                <i class="fas fa-gamepad"></i> Play
            </div>
            <div class="tab" data-tab="create">
                <i class="fas fa-plus-circle"></i> Create
            </div>
            <div class="tab" data-tab="history">
                <i class="fas fa-history"></i> History
            </div>
            <div class="tab" data-tab="admin" id="adminTab">
                <i class="fas fa-shield-alt"></i> Admin
                <span class="tab-badge hidden" id="adminBadge">0</span>
            </div>
        </div>
        
        <div class="game-area">
            <div class="main-content">
                <!-- Play Tab -->
                <div class="tab-content active" id="playTab">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-trophy"></i> Active Challenges
                            </div>
                            <div class="badge badge-primary" id="activeCount">0 challenges</div>
                        </div>
                        <div id="questionsContainer">
                            <!-- Questions will be loaded here -->
                            <div class="empty-state">
                                <i class="fas fa-question-circle" style="font-size: 48px; color: var(--gray); margin-bottom: 15px;"></i>
                                <p>No active challenges available</p>
                                <button class="btn btn-primary mt-3" id="createFirstChallenge">
                                    <i class="fas fa-plus"></i> Create First Challenge
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Create Tab -->
                <div class="tab-content" id="createTab">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-edit"></i> Create New Challenge
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label class="form-label">Category</label>
                                <select class="form-control" id="questionCategory">
                                    <option value="aptitude">Aptitude</option>
                                    <option value="math">Mathematics</option>
                                    <option value="riddle">Riddles</option>
                                    <option value="gk">General Knowledge</option>
                                    <option value="science">Science</option>
                                    <option value="programming">Programming</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Difficulty</label>
                                <select class="form-control" id="questionDifficulty">
                                    <option value="easy">Easy (1x payout)</option>
                                    <option value="medium">Medium (1.5x payout)</option>
                                    <option value="hard">Hard (2x payout)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Bet Amount (₹)</label>
                                <input type="number" class="form-control" id="questionBet" min="10" step="10" value="50">
                                <small class="text-muted">Minimum ₹10, Maximum ₹10,000</small>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Question</label>
                                <textarea class="form-control form-textarea" id="questionText" placeholder="Enter your question here..."></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Correct Answer</label>
                                <input type="text" class="form-control" id="questionAnswer" placeholder="Enter the correct answer...">
                                <small class="text-muted">This will be hidden from other players</small>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Explanation (Optional)</label>
                                <textarea class="form-control form-textarea" id="questionExplanation" placeholder="Add explanation or solution method..."></textarea>
                                <small class="text-muted">This will be shown after the challenge is solved</small>
                            </div>
                            <button class="btn btn-primary" id="submitQuestion">
                                <i class="fas fa-paper-plane"></i> Submit Challenge
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- History Tab -->
                <div class="tab-content" id="historyTab">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-label">Total Earnings</div>
                            <div class="stat-value">₹<span id="totalEarnings">0</span></div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Total Spent</div>
                            <div class="stat-value">₹<span id="totalSpent">0</span></div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-chart-line"></i> Your Activity
                            </div>
                            <div class="badge badge-primary" id="historyCount">0 items</div>
                        </div>
                        <div class="card-body">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Description</th>
                                        <th>Amount</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="historyList">
                                    <!-- History items will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Admin Tab -->
                <div class="tab-content" id="adminTabContent">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-shield-alt"></i> Admin Dashboard
                            </div>
                            <div class="badge badge-danger">ADMIN</div>
                        </div>
                        <div class="card-body">
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-label">Pending Approvals</div>
                                    <div class="stat-value" id="pendingApprovals">0</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-label">Total Challenges</div>
                                    <div class="stat-value" id="totalChallenges">0</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-label">Active Users</div>
                                    <div class="stat-value" id="activeUsers">0</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-label">Platform Balance</div>
                                    <div class="stat-value">₹<span id="platformBalance">0</span></div>
                                </div>
                            </div>
                            
                            <h4 style="margin: 20px 0 15px;">
                                <i class="fas fa-clipboard-list"></i> Pending Challenges
                            </h4>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Question</th>
                                        <th>Category</th>
                                        <th>Amount</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="adminPendingList">
                                    <!-- Pending challenges will be loaded here -->
                                </tbody>
                            </table>
                            
                            <h4 style="margin: 20px 0 15px;">
                                <i class="fas fa-flag"></i> Reported Challenges
                            </h4>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Question</th>
                                        <th>Reports</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="adminReportedList">
                                    <!-- Reported challenges will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="sidebar">
                <!-- Leaderboard Card -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-crown"></i> Top Solvers
                        </div>
                    </div>
                    <div class="card-body">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Player</th>
                                    <th>Wins</th>
                                </tr>
                            </thead>
                            <tbody id="leaderboardList">
                                <!-- Leaderboard will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Quick Stats Card -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-chart-pie"></i> Your Stats
                        </div>
                    </div>
                    <div class="card-body">
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span>Challenges Created</span>
                                <strong id="statsCreated">0</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span>Challenges Solved</span>
                                <strong id="statsSolved">0</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>Success Rate</span>
                                <strong id="statsRate">0%</strong>
                            </div>
                        </div>
                        <div class="progress" style="height: 10px; background-color: var(--gray); border-radius: 5px; margin-bottom: 15px;">
                            <div id="successProgress" class="progress-bar" style="height: 100%; width: 0%; background-color: var(--success); border-radius: 5px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Auth Modal -->
    <div class="modal" id="authModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="authModalTitle">Login</div>
                <button class="btn btn-sm btn-danger" id="closeAuthModal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="loginForm">
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-control" id="loginEmail" placeholder="Enter your email">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-control" id="loginPassword" placeholder="Enter your password">
                    </div>
                    <div class="form-group" style="text-align: right;">
                        <a href="#" id="showForgotPassword">Forgot password?</a>
                    </div>
                    <button class="btn btn-primary btn-block" id="doLogin">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                    <div style="text-align: center; margin-top: 15px;">
                        Don't have an account? <a href="#" id="showRegister">Register</a>
                    </div>
                </div>
                
                <div id="registerForm" class="hidden">
                    <div class="form-group">
                        <label class="form-label">Full Name</label>
                        <input type="text" class="form-control" id="registerName" placeholder="Enter your full name">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-control" id="registerEmail" placeholder="Enter your email">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-control" id="registerPassword" placeholder="Create a password">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Confirm Password</label>
                        <input type="password" class="form-control" id="registerConfirm" placeholder="Confirm your password">
                    </div>
                    <button class="btn btn-primary btn-block" id="doRegister">
                        <i class="fas fa-user-plus"></i> Register
                    </button>
                    <div style="text-align: center; margin-top: 15px;">
                        Already have an account? <a href="#" id="showLogin">Login</a>
                    </div>
                </div>
                
                <div id="forgotPasswordForm" class="hidden">
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-control" id="forgotEmail" placeholder="Enter your email">
                    </div>
                    <button class="btn btn-primary btn-block" id="doForgotPassword">
                        <i class="fas fa-key"></i> Reset Password
                    </button>
                    <div style="text-align: center; margin-top: 15px;">
                        Remember your password? <a href="#" id="showLoginFromForgot">Login</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Add Funds Modal -->
    <div class="modal" id="addFundsModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-wallet"></i> Add Funds
                </div>
                <button class="btn btn-sm btn-danger" id="closeAddFundsModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Amount (₹)</label>
                    <input type="number" class="form-control" id="addAmount" min="100" step="100" value="500">
                    <small class="text-muted">Minimum ₹100</small>
                </div>
                <div class="form-group">
                    <label class="form-label">Payment Method</label>
                    <select class="form-control" id="paymentMethod">
                        <option value="upi">UPI</option>
                        <option value="card">Credit/Debit Card</option>
                        <option value="netbanking">Net Banking</option>
                        <option value="wallet">Wallet</option>
                    </select>
                </div>
                <div id="paymentDetails">
                    <!-- Payment details will be shown here based on selection -->
                    <div class="form-group" id="upiDetails">
                        <label class="form-label">UPI ID</label>
                        <input type="text" class="form-control" id="upiId" placeholder="yourname@upi">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="cancelAddFunds">Cancel</button>
                <button class="btn btn-success" id="confirmAddFunds">Proceed to Pay</button>
            </div>
        </div>
    </div>
    
    <!-- Question Detail Modal -->
    <div class="modal" id="questionModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="questionModalTitle">Challenge Details</div>
                <button class="btn btn-sm btn-danger" id="closeQuestionModal">&times;</button>
            </div>
            <div class="modal-body" id="questionModalBody">
                <!-- Question details will be loaded here -->
            </div>
            <div class="modal-footer" id="questionModalFooter">
                <!-- Action buttons will be loaded here -->
            </div>
        </div>
    </div>
    
    <!-- Notification Area -->
    <div id="notificationArea"></div>
    
    <script>
        // Game state with more realistic data
        const state = {
            authenticated: false,
            currentUser: null,
            users: [
                {
                    id: 1,
                    name: "Admin User",
                    email: "admin@brainduel.com",
                    password: "admin123",
                    balance: 5000,
                    isAdmin: true,
                    stats: {
                        created: 15,
                        solved: 42,
                        earnings: 3250
                    }
                },
                {
                    id: 2,
                    name: "Test User",
                    email: "user@test.com",
                    password: "test123",
                    balance: 1500,
                    isAdmin: false,
                    stats: {
                        created: 8,
                        solved: 23,
                        earnings: 1250
                    }
                }
            ],
            questions: [
                {
                    id: 1,
                    userId: 2,
                    category: "math",
                    difficulty: "medium",
                    question: "What is the value of π rounded to 5 decimal places?",
                    answer: "3.14159",
                    explanation: "π (pi) is a mathematical constant representing the ratio of a circle's circumference to its diameter. Its approximate value is 3.1415926535...",
                    bet: 75,
                    status: "active",
                    createdAt: new Date(Date.now() - 3600000),
                    expiresAt: new Date(Date.now() + 82800000),
                    attempts: 3,
                    reports: 0
                },
                {
                    id: 2,
                    userId: 1,
                    category: "riddle",
                    difficulty: "hard",
                    question: "I speak without a mouth and hear without ears. I have no body, but I come alive with wind. What am I?",
                    answer: "echo",
                    explanation: "An echo is a reflection of sound that arrives at the listener some time after the original sound.",
                    bet: 150,
                    status: "active",
                    createdAt: new Date(Date.now() - 7200000),
                    expiresAt: new Date(Date.now() + 79200000),
                    attempts: 5,
                    reports: 0
                },
                {
                    id: 3,
                    userId: 2,
                    category: "aptitude",
                    difficulty: "easy",
                    question: "If a train travels 300 km in 3 hours, what is its speed in km/h?",
                    answer: "100",
                    explanation: "Speed = Distance / Time. So 300 km / 3 hours = 100 km/h",
                    bet: 50,
                    status: "active",
                    createdAt: new Date(Date.now() - 1800000),
                    expiresAt: new Date(Date.now() + 84600000),
                    attempts: 2,
                    reports: 0
                },
                {
                    id: 4,
                    userId: 1,
                    category: "programming",
                    difficulty: "hard",
                    question: "What does the 'this' keyword refer to in JavaScript?",
                    answer: "The object that is executing the current function",
                    explanation: "In JavaScript, the 'this' keyword refers to the object that is executing the current function. Its value depends on how a function is called.",
                    bet: 200,
                    status: "pending",
                    createdAt: new Date(Date.now() - 14400000),
                    expiresAt: null,
                    attempts: 0,
                    reports: 0
                }
            ],
            history: [
                {
                    id: 1,
                    userId: 2,
                    type: "win",
                    amount: 100,
                    description: "Solved 'What is 2^10?'",
                    date: new Date(Date.now() - 86400000),
                    questionId: 5
                },
                {
                    id: 2,
                    userId: 2,
                    type: "loss",
                    amount: 50,
                    description: "Failed to solve 'Capital of Australia'",
                    date: new Date(Date.now() - 172800000),
                    questionId: 6
                },
                {
                    id: 3,
                    userId: 2,
                    type: "win",
                    amount: 150,
                    description: "Your question wasn't solved",
                    date: new Date(Date.now() - 259200000),
                    questionId: 7
                }
            ],
            leaderboard: [
                { userId: 1, name: "Admin User", wins: 42, earnings: 3250 },
                { userId: 3, name: "MathWizard", wins: 35, earnings: 2800 },
                { userId: 4, name: "PuzzleMaster", wins: 28, earnings: 2100 },
                { userId: 2, name: "Test User", wins: 23, earnings: 1250 },
                { userId: 5, name: "CodeNinja", wins: 18, earnings: 950 }
            ],
            pendingApprovals: 1,
            reportedQuestions: 0,
            platformBalance: 500
        };

        // DOM elements
        const elements = {
            // Authentication elements
            authButtons: document.getElementById('authButtons'),
            userProfile: document.getElementById('userProfile'),
            profileInitial: document.getElementById('profileInitial'),
            balance: document.getElementById('balance'),
            loginBtn: document.getElementById('loginBtn'),
            registerBtn: document.getElementById('registerBtn'),
            
            // Modal elements
            authModal: document.getElementById('authModal'),
            authModalTitle: document.getElementById('authModalTitle'),
            loginForm: document.getElementById('loginForm'),
            registerForm: document.getElementById('registerForm'),
            forgotPasswordForm: document.getElementById('forgotPasswordForm'),
            closeAuthModal: document.getElementById('closeAuthModal'),
            doLogin: document.getElementById('doLogin'),
            doRegister: document.getElementById('doRegister'),
            showRegister: document.getElementById('showRegister'),
            showLogin: document.getElementById('showLogin'),
            showForgotPassword: document.getElementById('showForgotPassword'),
            showLoginFromForgot: document.getElementById('showLoginFromForgot'),
            doForgotPassword: document.getElementById('doForgotPassword'),
            
            // Wallet elements
            addFundsBtn: document.getElementById('addFundsBtn'),
            addFundsModal: document.getElementById('addFundsModal'),
            closeAddFundsModal: document.getElementById('closeAddFundsModal'),
            cancelAddFunds: document.getElementById('cancelAddFunds'),
            confirmAddFunds: document.getElementById('confirmAddFunds'),
            addAmount: document.getElementById('addAmount'),
            paymentMethod: document.getElementById('paymentMethod'),
            paymentDetails: document.getElementById('paymentDetails'),
            
            // Tab elements
            tabs: document.querySelectorAll('.tab'),
            tabContents: document.querySelectorAll('.tab-content'),
            adminTab: document.getElementById('adminTab'),
            adminTabContent: document.getElementById('adminTabContent'),
            adminBadge: document.getElementById('adminBadge'),
            
            // Play tab elements
            questionsContainer: document.getElementById('questionsContainer'),
            activeCount: document.getElementById('activeCount'),
            createFirstChallenge: document.getElementById('createFirstChallenge'),
            questionModal: document.getElementById('questionModal'),
            closeQuestionModal: document.getElementById('closeQuestionModal'),
            questionModalTitle: document.getElementById('questionModalTitle'),
            questionModalBody: document.getElementById('questionModalBody'),
            questionModalFooter: document.getElementById('questionModalFooter'),
            
            // Create tab elements
            questionCategory: document.getElementById('questionCategory'),
            questionDifficulty: document.getElementById('questionDifficulty'),
            questionBet: document.getElementById('questionBet'),
            questionText: document.getElementById('questionText'),
            questionAnswer: document.getElementById('questionAnswer'),
            questionExplanation: document.getElementById('questionExplanation'),
            submitQuestion: document.getElementById('submitQuestion'),
            
            // History tab elements
            historyList: document.getElementById('historyList'),
            historyCount: document.getElementById('historyCount'),
            totalEarnings: document.getElementById('totalEarnings'),
            totalSpent: document.getElementById('totalSpent'),
            
            // Stats elements
            statsCreated: document.getElementById('statsCreated'),
            statsSolved: document.getElementById('statsSolved'),
            statsRate: document.getElementById('statsRate'),
            successProgress: document.getElementById('successProgress'),
            
            // Leaderboard elements
            leaderboardList: document.getElementById('leaderboardList'),
            
            // Admin elements
            pendingApprovals: document.getElementById('pendingApprovals'),
            totalChallenges: document.getElementById('totalChallenges'),
            activeUsers: document.getElementById('activeUsers'),
            platformBalance: document.getElementById('platformBalance'),
            adminPendingList: document.getElementById('adminPendingList'),
            adminReportedList: document.getElementById('adminReportedList'),
            
            // Notification area
            notificationArea: document.getElementById('notificationArea')
        };

        // Initialize the app
        function init() {
            setupEventListeners();
            renderPublicData();
            
            // Check if user is already logged in (for demo purposes)
            const demoUser = state.users.find(u => u.email === "user@test.com");
            if (demoUser) {
                loginUser(demoUser);
            }
        }

        // Set up event listeners
        function setupEventListeners() {
            // Authentication
            elements.loginBtn.addEventListener('click', () => showAuthModal('login'));
            elements.registerBtn.addEventListener('click', () => showAuthModal('register'));
            elements.closeAuthModal.addEventListener('click', () => hideAuthModal());
            elements.doLogin.addEventListener('click', handleLogin);
            elements.doRegister.addEventListener('click', handleRegister);
            elements.showRegister.addEventListener('click', () => showAuthModal('register'));
            elements.showLogin.addEventListener('click', () => showAuthModal('login'));
            elements.showForgotPassword.addEventListener('click', () => showAuthModal('forgot'));
            elements.showLoginFromForgot.addEventListener('click', () => showAuthModal('login'));
            elements.doForgotPassword.addEventListener('click', handleForgotPassword);
            
            // Wallet
            elements.addFundsBtn.addEventListener('click', () => elements.addFundsModal.classList.add('active'));
            elements.closeAddFundsModal.addEventListener('click', () => elements.addFundsModal.classList.remove('active'));
            elements.cancelAddFunds.addEventListener('click', () => elements.addFundsModal.classList.remove('active'));
            elements.confirmAddFunds.addEventListener('click', addFunds);
            elements.paymentMethod.addEventListener('change', updatePaymentDetails);
            
            // Tabs
            elements.tabs.forEach(tab => {
                tab.addEventListener('click', () => switchTab(tab.getAttribute('data-tab')));
            });
            
            // Questions
            elements.createFirstChallenge.addEventListener('click', () => switchTab('create'));
            elements.submitQuestion.addEventListener('click', createQuestion);
            
            // Close question modal
            elements.closeQuestionModal.addEventListener('click', () => elements.questionModal.classList.remove('active'));
        }

        // Show authentication modal
        function showAuthModal(type) {
            elements.authModal.classList.add('active');
            
            elements.loginForm.classList.add('hidden');
            elements.registerForm.classList.add('hidden');
            elements.forgotPasswordForm.classList.add('hidden');
            
            if (type === 'login') {
                elements.authModalTitle.textContent = 'Login';
                elements.loginForm.classList.remove('hidden');
            } else if (type === 'register') {
                elements.authModalTitle.textContent = 'Register';
                elements.registerForm.classList.remove('hidden');
            } else if (type === 'forgot') {
                elements.authModalTitle.textContent = 'Reset Password';
                elements.forgotPasswordForm.classList.remove('hidden');
            }
        }

        // Hide authentication modal
        function hideAuthModal() {
            elements.authModal.classList.remove('active');
        }

        // Handle login
        function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            const user = state.users.find(u => u.email === email && u.password === password);
            
            if (user) {
                loginUser(user);
                hideAuthModal();
                showNotification('Login successful!', 'success');
            } else {
                showNotification('Invalid email or password', 'error');
            }
        }

        // Handle registration
        function handleRegister() {
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirm = document.getElementById('registerConfirm').value;
            
            if (password !== confirm) {
                showNotification('Passwords do not match', 'error');
                return;
            }
            
            if (state.users.some(u => u.email === email)) {
                showNotification('Email already registered', 'error');
                return;
            }
            
            const newUser = {
                id: state.users.length + 1,
                name,
                email,
                password,
                balance: 1000, // Starting bonus
                isAdmin: false,
                stats: {
                    created: 0,
                    solved: 0,
                    earnings: 0
                }
            };
            
            state.users.push(newUser);
            loginUser(newUser);
            hideAuthModal();
            showNotification('Registration successful! ₹1000 bonus added to your account', 'success');
        }

        // Handle forgot password
        function handleForgotPassword() {
            const email = document.getElementById('forgotEmail').value;
            
            if (state.users.some(u => u.email === email)) {
                showNotification('Password reset link sent to your email', 'success');
                hideAuthModal();
            } else {
                showNotification('Email not found', 'error');
            }
        }

        // Login user
        function loginUser(user) {
            state.authenticated = true;
            state.currentUser = user;
            
            // Update UI
            elements.authButtons.classList.add('hidden');
            elements.userProfile.classList.remove('hidden');
            elements.profileInitial.textContent = user.name.charAt(0).toUpperCase();
            updateBalance();
            
            // Render user-specific data
            renderUserData();
            
            // Show admin tab if user is admin
            if (user.isAdmin) {
                elements.adminTab.classList.remove('hidden');
                renderAdminData();
            } else {
                elements.adminTab.classList.add('hidden');
            }
        }

        // Logout user
        function logoutUser() {
            state.authenticated = false;
            state.currentUser = null;
            
            // Update UI
            elements.authButtons.classList.remove('hidden');
            elements.userProfile.classList.add('hidden');
            
            // Render public data
            renderPublicData();
        }

        // Update payment details based on selected method
        function updatePaymentDetails() {
            const method = elements.paymentMethod.value;
            elements.paymentDetails.innerHTML = '';
            
            if (method === 'upi') {
                elements.paymentDetails.innerHTML = `
                    <div class="form-group" id="upiDetails">
                        <label class="form-label">UPI ID</label>
                        <input type="text" class="form-control" id="upiId" placeholder="yourname@upi">
                    </div>
                `;
            } else if (method === 'card') {
                elements.paymentDetails.innerHTML = `
                    <div class="form-group">
                        <label class="form-label">Card Number</label>
                        <input type="text" class="form-control" id="cardNumber" placeholder="1234 5678 9012 3456">
                    </div>
                    <div style="display: flex; gap: 15px;">
                        <div class="form-group" style="flex: 1;">
                            <label class="form-label">Expiry Date</label>
                            <input type="text" class="form-control" id="cardExpiry" placeholder="MM/YY">
                        </div>
                        <div class="form-group" style="flex: 1;">
                            <label class="form-label">CVV</label>
                            <input type="text" class="form-control" id="cardCvv" placeholder="123">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Cardholder Name</label>
                        <input type="text" class="form-control" id="cardName" placeholder="John Doe">
                    </div>
                `;
            } else if (method === 'netbanking') {
                elements.paymentDetails.innerHTML = `
                    <div class="form-group">
                        <label class="form-label">Bank</label>
                        <select class="form-control" id="bankSelect">
                            <option value="">Select your bank</option>
                            <option value="sbi">State Bank of India</option>
                            <option value="hdfc">HDFC Bank</option>
                            <option value="icici">ICICI Bank</option>
                            <option value="axis">Axis Bank</option>
                        </select>
                    </div>
                `;
            } else if (method === 'wallet') {
                elements.paymentDetails.innerHTML = `
                    <div class="form-group">
                        <label class="form-label">Wallet</label>
                        <select class="form-control" id="walletSelect">
                            <option value="">Select your wallet</option>
                            <option value="paytm">Paytm</option>
                            <option value="phonepe">PhonePe</option>
                            <option value="amazonpay">Amazon Pay</option>
                        </select>
                    </div>
                `;
            }
        }

        // Add funds to wallet
        function addFunds() {
            const amount = parseInt(elements.addAmount.value);
            
            if (amount >= 100) {
                state.currentUser.balance += amount;
                updateBalance();
                elements.addFundsModal.classList.remove('active');
                showNotification(`Successfully added ₹${amount} to your wallet`, 'success');
                
                // Add to history
                addHistoryItem('deposit', amount, 'Added funds to wallet');
                
                // Update platform balance (5% fee)
                state.platformBalance += Math.floor(amount * 0.05);
                if (state.currentUser.isAdmin) {
                    renderAdminData();
                }
            } else {
                showNotification('Minimum deposit amount is ₹100', 'error');
            }
        }

        // Update balance display
        function updateBalance() {
            if (state.currentUser) {
                elements.balance.textContent = state.currentUser.balance;
            }
        }

        // Switch between tabs
        function switchTab(tabName) {
            // Update active tab
            elements.tabs.forEach(tab => {
                if (tab.getAttribute('data-tab') === tabName) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
            
            // Update active content
            elements.tabContents.forEach(content => {
                if (content.id === `${tabName}Tab`) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });
            
            // Load data if needed
            if (tabName === 'admin') {
                renderAdminData();
            }
        }

        // Create a new question
        function createQuestion() {
            if (!state.authenticated) {
                showNotification('Please login to create challenges', 'error');
                showAuthModal('login');
                return;
            }
            
            const category = elements.questionCategory.value;
            const difficulty = elements.questionDifficulty.value;
            const bet = parseInt(elements.questionBet.value);
            const question = elements.questionText.value.trim();
            const answer = elements.questionAnswer.value.trim();
            const explanation = elements.questionExplanation.value.trim();
            
            if (!question || !answer) {
                showNotification('Please enter both question and answer', 'error');
                return;
            }
            
            if (bet < 10 || bet > 10000) {
                showNotification('Bet amount must be between ₹10 and ₹10,000', 'error');
                return;
            }
            
            if (bet > state.currentUser.balance) {
                showNotification('You don\'t have enough balance', 'error');
                return;
            }
            
            // Deduct bet amount
            state.currentUser.balance -= bet;
            updateBalance();
            
            // Create new question
            const newQuestion = {
                id: state.questions.length + 1,
                userId: state.currentUser.id,
                category,
                difficulty,
                question,
                answer,
                explanation,
                bet,
                status: state.currentUser.isAdmin ? 'active' : 'pending',
                createdAt: new Date(),
                expiresAt: state.currentUser.isAdmin ? new Date(Date.now() + 86400000) : null,
                attempts: 0,
                reports: 0
            };
            
            state.questions.unshift(newQuestion);
            
            // Update stats
            state.currentUser.stats.created++;
            
            // Add to history
            addHistoryItem('question', bet, `Created: "${question.substring(0, 20)}..."`);
            
            // Update admin badge if needed
            if (!state.currentUser.isAdmin) {
                state.pendingApprovals++;
                updateAdminBadge();
            }
            
            // Reset form
            elements.questionText.value = '';
            elements.questionAnswer.value = '';
            elements.questionExplanation.value = '';
            
            showNotification('Challenge created successfully! ' + 
                (state.currentUser.isAdmin ? 'It\'s now live.' : 'Waiting for admin approval.'), 
                'success');
            
            // Refresh views
            renderQuestions();
            renderUserStats();
            
            if (state.currentUser.isAdmin) {
                renderAdminData();
            }
        }

        // Submit answer to a question
        function submitAnswer(questionId, answer) {
            const question = state.questions.find(q => q.id === questionId);
            if (!question || question.status !== 'active') return;
            
            question.attempts++;
            
            if (answer.toLowerCase() === question.answer.toLowerCase()) {
                // Correct answer
                const winnings = calculateWinnings(question.bet, question.difficulty);
                state.currentUser.balance += winnings;
                
                // Update question owner's balance
                const questionOwner = state.users.find(u => u.id === question.userId);
                if (questionOwner) {
                    questionOwner.balance -= winnings;
                }
                
                // Update platform balance (5% fee)
                state.platformBalance += Math.floor(winnings * 0.05);
                
                showNotification(`Correct! You won ₹${winnings}`, 'success');
                
                // Update stats
                state.currentUser.stats.solved++;
                state.currentUser.stats.earnings += winnings;
                
                // Add to history
                addHistoryItem('win', winnings, `Solved "${question.question.substring(0, 20)}..."`, question.id);
                
                // Mark question as resolved
                question.status = 'resolved';
            } else {
                // Wrong answer
                state.currentUser.balance -= question.bet;
                
                // Update question owner's balance
                const questionOwner = state.users.find(u => u.id === question.userId);
                if (questionOwner) {
                    questionOwner.balance += question.bet * 2; // Owner gets double
                }
                
                // Update platform balance (5% fee)
                state.platformBalance += Math.floor(question.bet * 0.05);
                
                showNotification(`Wrong answer! You lost ₹${question.bet}`, 'error');
                
                // Add to history
                addHistoryItem('loss', question.bet, `Failed to solve "${question.question.substring(0, 20)}..."`, question.id);
            }
            
            updateBalance();
            renderQuestions();
            renderUserStats();
            renderHistory();
            
            if (state.currentUser.isAdmin) {
                renderAdminData();
            }
        }

        // Calculate winnings based on difficulty
        function calculateWinnings(baseAmount, difficulty) {
            switch (difficulty) {
                case 'easy': return baseAmount;
                case 'medium': return Math.floor(baseAmount * 1.5);
                case 'hard': return baseAmount * 2;
                default: return baseAmount;
            }
        }

        // Add item to history
        function addHistoryItem(type, amount, description, questionId = null) {
            const newItem = {
                id: state.history.length + 1,
                userId: state.currentUser.id,
                type,
                amount,
                description,
                date: new Date(),
                questionId
            };
            
            state.history.unshift(newItem);
            renderHistory();
        }

        // Show notification
        function showNotification(message, type) {
            const icon = type === 'success' ? 'fa-check-circle' : 
                        type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle';
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas ${icon} notification-icon"></i>
                <span>${message}</span>
            `;
            elements.notificationArea.appendChild(notification);
            
            // Remove after animation
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Render public data (visible to all)
        function renderPublicData() {
            renderQuestions();
            renderLeaderboard();
        }

        // Render user-specific data
        function renderUserData() {
            renderQuestions();
            renderHistory();
            renderUserStats();
            renderLeaderboard();
        }

        // Render admin data
        function renderAdminData() {
            elements.pendingApprovals.textContent = state.pendingApprovals;
            elements.totalChallenges.textContent = state.questions.length;
            elements.activeUsers.textContent = state.users.filter(u => !u.isAdmin).length;
            elements.platformBalance.textContent = state.platformBalance;
            
            // Update admin badge
            updateAdminBadge();
            
            // Render pending questions
            renderAdminPendingQuestions();
            
            // Render reported questions (demo - none yet)
            elements.adminReportedList.innerHTML = `
                <tr>
                    <td colspan="4" style="text-align: center; padding: 20px;">
                        No reported challenges at this time
                    </td>
                </tr>
            `;
        }

        // Update admin badge
        function updateAdminBadge() {
            if (state.pendingApprovals > 0) {
                elements.adminBadge.textContent = state.pendingApprovals;
                elements.adminBadge.classList.remove('hidden');
            } else {
                elements.adminBadge.classList.add('hidden');
            }
        }

        // Render questions
        function renderQuestions() {
            elements.questionsContainer.innerHTML = '';
            
            const activeQuestions = state.questions.filter(q => q.status === 'active');
            elements.activeCount.textContent = `${activeQuestions.length} challenge${activeQuestions.length !== 1 ? 's' : ''}`;
            
            if (activeQuestions.length === 0) {
                elements.questionsContainer.innerHTML = `
                    <div class="empty-state" style="text-align: center; padding: 30px;">
                        <i class="fas fa-question-circle" style="font-size: 48px; color: var(--gray); margin-bottom: 15px;"></i>
                        <p>No active challenges available</p>
                        ${state.authenticated ? `
                            <button class="btn btn-primary mt-3" id="createFirstChallenge">
                                <i class="fas fa-plus"></i> Create First Challenge
                            </button>
                        ` : `
                            <button class="btn btn-primary mt-3" onclick="showAuthModal('login')">
                                <i class="fas fa-sign-in-alt"></i> Login to Create
                            </button>
                        `}
                    </div>
                `;
                return;
            }
            
            activeQuestions.forEach(question => {
                const timeLeft = Math.floor((question.expiresAt - new Date()) / 3600000);
                const difficultyClass = `difficulty-${question.difficulty}`;
                let multiplier = '1x';
                
                if (question.difficulty === 'medium') multiplier = '1.5x';
                if (question.difficulty === 'hard') multiplier = '2x';
                
                const questionUser = state.users.find(u => u.id === question.userId);
                const authorName = questionUser ? questionUser.name : 'Unknown';
                const authorInitial = authorName.charAt(0).toUpperCase();
                
                const questionElement = document.createElement('div');
                questionElement.className = 'question-card';
                questionElement.innerHTML = `
                    <div class="question-header">
                        <div>
                            <span class="badge badge-primary">${question.category.toUpperCase()}</span>
                            <span class="difficulty-tag ${difficultyClass}">${question.difficulty.toUpperCase()}</span>
                        </div>
                        <div class="question-bet">₹${question.bet} (${multiplier})</div>
                    </div>
                    <div class="question-text">${question.question}</div>
                    <div class="question-meta">
                        <div class="question-author">
                            <div class="author-avatar">${authorInitial}</div>
                            <span>${authorName}</span>
                        </div>
                        <div class="question-timer">
                            <i class="fas fa-clock"></i> ${timeLeft} hours left
                        </div>
                    </div>
                    ${state.authenticated ? `
                        <form class="answer-form" data-question-id="${question.id}">
                            <input type="text" class="answer-input form-control" placeholder="Your answer..." required>
                            <button type="submit" class="btn btn-success">
                                <i class="fas fa-paper-plane"></i> Submit
                            </button>
                        </form>
                    ` : `
                        <button class="btn btn-primary btn-block" onclick="showAuthModal('login')">
                            <i class="fas fa-sign-in-alt"></i> Login to Answer
                        </button>
                    `}
                `;
                
                elements.questionsContainer.appendChild(questionElement);
                
                // Add answer submission handler if authenticated
                if (state.authenticated) {
                    const form = questionElement.querySelector('.answer-form');
                    form.addEventListener('submit', (e) => {
                        e.preventDefault();
                        const answerInput = form.querySelector('.answer-input');
                        submitAnswer(question.id, answerInput.value.trim());
                        answerInput.value = '';
                    });
                }
            });
        }

        // Render admin pending questions
        function renderAdminPendingQuestions() {
            const pendingQuestions = state.questions.filter(q => q.status === 'pending');
            
            if (pendingQuestions.length === 0) {
                elements.adminPendingList.innerHTML = `
                    <tr>
                        <td colspan="4" style="text-align: center; padding: 20px;">
                            No pending challenges at this time
                        </td>
                    </tr>
                `;
                return;
            }
            
            elements.adminPendingList.innerHTML = '';
            
            pendingQuestions.forEach(question => {
                const questionUser = state.users.find(u => u.id === question.userId);
                const authorName = questionUser ? questionUser.name : 'Unknown';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${question.question.substring(0, 30)}...</td>
                    <td>${question.category}</td>
                    <td>₹${question.bet}</td>
                    <td class="admin-actions">
                        <button class="btn btn-success btn-sm" data-action="approve" data-id="${question.id}">
                            <i class="fas fa-check"></i> Approve
                        </button>
                        <button class="btn btn-danger btn-sm" data-action="reject" data-id="${question.id}">
                            <i class="fas fa-times"></i> Reject
                        </button>
                        <button class="btn btn-primary btn-sm" data-action="view" data-id="${question.id}">
                            <i class="fas fa-eye"></i> View
                        </button>
                    </td>
                `;
                
                elements.adminPendingList.appendChild(row);
                
                // Add action handlers
                row.querySelectorAll('button').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const action = btn.getAttribute('data-action');
                        const id = parseInt(btn.getAttribute('data-id'));
                        handleAdminQuestionAction(id, action);
                    });
                });
            });
        }

        // Handle admin question actions
        function handleAdminQuestionAction(questionId, action) {
            const question = state.questions.find(q => q.id === questionId);
            if (!question) return;
            
            if (action === 'approve') {
                question.status = 'active';
                question.expiresAt = new Date(Date.now() + 86400000); // 24 hours from now
                state.pendingApprovals--;
                
                // Notify question owner
                const questionOwner = state.users.find(u => u.id === question.userId);
                if (questionOwner) {
                    showNotification(`Challenge "${question.question.substring(0, 20)}..." approved and is now live`, 'success');
                }
            } else if (action === 'reject') {
                question.status = 'rejected';
                state.pendingApprovals--;
                
                // Refund to question owner
                const questionOwner = state.users.find(u => u.id === question.userId);
                if (questionOwner) {
                    questionOwner.balance += question.bet;
                    showNotification(`Challenge "${question.question.substring(0, 20)}..." rejected and amount refunded`, 'warning');
                }
            } else if (action === 'view') {
                // Show question details (implement view modal)
                showQuestionModal(question);
                return;
            }
            
            // Update views
            renderQuestions();
            renderAdminData();
            updateAdminBadge();
        }

        // Show question modal
        function showQuestionModal(question) {
            elements.questionModalTitle.textContent = 'Challenge Details';
            
            const questionUser = state.users.find(u => u.id === question.userId);
            const authorName = questionUser ? questionUser.name : 'Unknown';
            const authorInitial = authorName.charAt(0).toUpperCase();
            
            let statusBadge = '';
            if (question.status === 'active') statusBadge = '<span class="badge badge-success">ACTIVE</span>';
            else if (question.status === 'pending') statusBadge = '<span class="badge badge-warning">PENDING</span>';
            else if (question.status === 'rejected') statusBadge = '<span class="badge badge-danger">REJECTED</span>';
            else if (question.status === 'resolved') statusBadge = '<span class="badge badge-primary">RESOLVED</span>';
            
            elements.questionModalBody.innerHTML = `
                <div style="margin-bottom: 15px;">
                    ${statusBadge}
                    <span class="badge badge-primary">${question.category.toUpperCase()}</span>
                    <span class="difficulty-tag difficulty-${question.difficulty}">${question.difficulty.toUpperCase()}</span>
                </div>
                
                <div class="question-text" style="font-size: 18px; margin-bottom: 20px;">
                    ${question.question}
                </div>
                
                <div style="background-color: var(--light); padding: 15px; border-radius: 5px; margin-bottom: 20px;">
                    <h4 style="margin-bottom: 10px;">
                        <i class="fas fa-info-circle"></i> Challenge Details
                    </h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div>
                            <div style="font-weight: bold;">Bet Amount</div>
                            <div>₹${question.bet}</div>
                        </div>
                        <div>
                            <div style="font-weight: bold;">Payout</div>
                            <div>${calculateWinnings(question.bet, question.difficulty)}x</div>
                        </div>
                        <div>
                            <div style="font-weight: bold;">Created</div>
                            <div>${question.createdAt.toLocaleString()}</div>
                        </div>
                        <div>
                            <div style="font-weight: bold;">Expires</div>
                            <div>${question.expiresAt ? question.expiresAt.toLocaleString() : 'Not set'}</div>
                        </div>
                        <div>
                            <div style="font-weight: bold;">Attempts</div>
                            <div>${question.attempts}</div>
                        </div>
                        <div>
                            <div style="font-weight: bold;">Author</div>
                            <div>
                                <span class="author-avatar">${authorInitial}</span>
                                ${authorName}
                            </div>
                        </div>
                    </div>
                </div>
                
                ${question.explanation ? `
                    <div style="margin-bottom: 20px;">
                        <h4 style="margin-bottom: 10px;">
                            <i class="fas fa-lightbulb"></i> Explanation
                        </h4>
                        <p>${question.explanation}</p>
                    </div>
                ` : ''}
                
                ${state.currentUser && state.currentUser.isAdmin ? `
                    <div style="background-color: #fff8e1; padding: 15px; border-radius: 5px;">
                        <h4 style="margin-bottom: 10px; color: #ff8f00;">
                            <i class="fas fa-shield-alt"></i> Admin Information
                        </h4>
                        <div style="font-family: monospace; word-break: break-all;">
                            <div><strong>Correct Answer:</strong> ${question.answer}</div>
                        </div>
                    </div>
                ` : ''}
            `;
            
            elements.questionModalFooter.innerHTML = '';
            
            if (state.currentUser && state.currentUser.isAdmin && question.status === 'pending') {
                elements.questionModalFooter.innerHTML = `
                    <button class="btn btn-success" data-action="approve" data-id="${question.id}">
                        <i class="fas fa-check"></i> Approve
                    </button>
                    <button class="btn btn-danger" data-action="reject" data-id="${question.id}">
                        <i class="fas fa-times"></i> Reject
                    </button>
                `;
                
                elements.questionModalFooter.querySelectorAll('button').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const action = btn.getAttribute('data-action');
                        const id = parseInt(btn.getAttribute('data-id'));
                        handleAdminQuestionAction(id, action);
                        elements.questionModal.classList.remove('active');
                    });
                });
            }
            
            elements.questionModal.classList.add('active');
        }

        // Render history
        function renderHistory() {
            elements.historyList.innerHTML = '';
            
            const userHistory = state.history.filter(h => h.userId === state.currentUser.id);
            elements.historyCount.textContent = `${userHistory.length} item${userHistory.length !== 1 ? 's' : ''}`;
            
            // Calculate totals
            let totalEarnings = 0;
            let totalSpent = 0;
            
            userHistory.forEach(item => {
                if (item.type === 'win') {
                    totalEarnings += item.amount;
                } else if (item.type === 'loss' || item.type === 'question') {
                    totalSpent += item.amount;
                }
            });
            
            elements.totalEarnings.textContent = totalEarnings;
            elements.totalSpent.textContent = totalSpent;
            
            if (userHistory.length === 0) {
                elements.historyList.innerHTML = `
                    <tr>
                        <td colspan="4" style="text-align: center; padding: 20px;">
                            No activity history yet
                        </td>
                    </tr>
                `;
                return;
            }
            
            userHistory.forEach(item => {
                const row = document.createElement('tr');
                
                let amountClass = '';
                let symbol = '';
                let icon = '';
                
                if (item.type === 'win') {
                    amountClass = 'text-success';
                    symbol = '+';
                    icon = 'fa-coins';
                } else if (item.type === 'loss') {
                    amountClass = 'text-danger';
                    symbol = '-';
                    icon = 'fa-times';
                } else if (item.type === 'question') {
                    amountClass = 'text-danger';
                    symbol = '-';
                    icon = 'fa-question';
                } else if (item.type === 'deposit') {
                    amountClass = 'text-success';
                    symbol = '+';
                    icon = 'fa-wallet';
                }
                
                row.innerHTML = `
                    <td>${item.date.toLocaleString()}</td>
                    <td>
                        <i class="fas ${icon}"></i> ${item.description}
                    </td>
                    <td class="${amountClass}">
                        ${symbol}₹${item.amount}
                    </td>
                    <td>
                        ${item.type === 'win' ? 'Won' : 
                          item.type === 'loss' ? 'Lost' : 
                          item.type === 'question' ? 'Challenge' : 'Deposit'}
                    </td>
                `;
                
                elements.historyList.appendChild(row);
            });
        }

        // Render user stats
        function renderUserStats() {
            if (!state.currentUser) return;
            
            const stats = state.currentUser.stats;
            elements.statsCreated.textContent = stats.created;
            elements.statsSolved.textContent = stats.solved;
            
            const successRate = stats.created > 0 ? Math.floor((stats.solved / stats.created) * 100) : 0;
            elements.statsRate.textContent = `${successRate}%`;
            elements.successProgress.style.width = `${successRate}%`;
        }

        // Render leaderboard
        function renderLeaderboard() {
            elements.leaderboardList.innerHTML = '';
            
            state.leaderboard.forEach((user, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${user.name}</td>
                    <td>${user.wins}</td>
                `;
                elements.leaderboardList.appendChild(row);
            });
        }

        // Initialize the app
        init();
    </script>
</body>
</html>